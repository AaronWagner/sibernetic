<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Sibernetic by openworm</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Sibernetic</h1>
        <p>This is a C++ implementation of the Contractile SPH (Electrofluid) algorithm applied to C. elegans locomotion</p>

        <p class="view"><a href="https://github.com/openworm/Smoothed-Particle-Hydrodynamics">View the Project on GitHub <small>openworm/Smoothed-Particle-Hydrodynamics</small></a></p>


        <ul>
          <li><a href="https://github.com/openworm/Smoothed-Particle-Hydrodynamics/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/openworm/Smoothed-Particle-Hydrodynamics/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/openworm/Smoothed-Particle-Hydrodynamics">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><img src="http://i.imgur.com/Hbsw6Zs.png" alt="Sibernetic"></p>

<p>Sibernetic is a fluid mechanics simulator developed for simulations of C. elegans in the <a href="http://www.openworm.org">OpenWorm project</a> developed for the <a href="http://openworm.org">OpenWorm</a> project by Andrey Palyanov, Sergey Khayrulin and Mike Vella as part of the <a href="http://www.openworm.org/people.html">OpenWorm team</a>. Sibernetic provides an implementation of the PCISPH contractile matter algorithm for simulating muscle tissue and is applies to C. elegans locomotion.</p>

<p>When driven by <a href="https://en.wikipedia.org/wiki/Hodgkin%E2%80%93Huxley_model">Hodgkin Huxley dynamics</a> contractile matter is called Electrofluid.</p>

<p>Sibernetic is primarily written in  C++ and OpenCL, it also provides a Python API.</p>

<p>There is a separate effort lead by <a href="https://github.com/gidili">Giovanni Idili</a> and <a href="https://github.com/skhayrulin">Sergey Khayrulin</a> to port this code to Java, as part of the <a href="https://github.com/openworm/OpenWorm/wiki/Geppetto--Overview">Geppetto simulation framework</a>. </p>

<h2>
<a name="compiling--running-linuxmac" class="anchor" href="#compiling--running-linuxmac"><span class="octicon octicon-link"></span></a>Compiling / running (Linux/mac)</h2>

<p><strong>Linux</strong></p>

<p>Install OpenCL on Ubuntu. We suggest you initially go with <a href="http://developer.amd.com/tools-and-sdks/heterogeneous-computing/amd-accelerated-parallel-processing-app-sdk/downloads/">AMD OpenCL drivers</a> as we have found these to be the most stable and complete. these are rpms but install instructions for Ubuntu can be found <a href="http://develnoter.blogspot.co.uk/2012/05/installing-opencl-in-ubuntu-1204.html">here</a>. This step often causes problems, contact the <a href="https://groups.google.com/forum/#!forum/openworm-discuss">openworm-discuss</a> mailing list if you encounter issues.</p>

<p>Navigate to the <code>Release</code> folder and run:</p>

<pre><code>make clean
make all
</code></pre>

<p><strong>Mac</strong>: stay in the top-level folder and run:</p>

<pre><code>make clean -f makefile.OSX
make all -f makefile.OSX
</code></pre>

<p>You should see an output which looks something like this:</p>

<pre><code>Building file: ../src/PyramidalSimulation.cpp
Invoking: GCC C++ Compiler

....
more stuff...
....

Building target: Smoothed-Particle-Hydrodynamics
Invoking: GCC C++ Linker
g++ -L/usr/lib -L/usr/lib/python2.7 -o "Smoothed-Particle-Hydrodynamics"  ./src/PyramidalSimulation.o ./src/main.o ./src/owHelper.o ./src/owOpenCLSolver.o ./src/owPhysicsFluidSimulator.o ./src/owWorldSimulation.o   -lOpenCL -lpython2.7 -lrt -lglut -lGL -lGLU
Finished building target: Smoothed-Particle-Hydrodynamics
</code></pre>

<p>Then navigate to the top-level folder in the hierarchy (e.g <code>Smoothed-Particle-Hydrodynamics</code>) and set your <code>PYTHONPATH</code>:</p>

<pre><code>export PYTHONPATH=$PYTHONPATH:'./src'
</code></pre>

<p>Finally, to run, run the command:</p>

<p><strong>Linux</strong>:</p>

<pre><code>./Release/Smoothed-Particle-Hydrodynamics
</code></pre>

<p><strong>Mac</strong>:</p>

<pre><code>./build/Smoothed-Particle-Hydrodynamics
</code></pre>

<p>You may need to make <code>./Release/Smoothed-Particle-Hydrodynamics</code> executable like so:</p>

<pre><code>chmod +x ./Release/Smoothed-Particle-Hydrodynamics
</code></pre>

<p>If you do not run from the top-level folder you will see an error which looks something like this:</p>

<pre><code>Compilation failed: 
"/tmp/OCLQ1BaOw.cl", line 8: catastrophic error: cannot open source file
"src//owOpenCLConstant.h"
#include "src//owOpenCLConstant.h"
</code></pre>

<h2>
<a name="saving-to-disk" class="anchor" href="#saving-to-disk"><span class="octicon octicon-link"></span></a>Saving to disk</h2>

<p>You may wish to save simulations to disk rather than visualise them (<strong>WARNING</strong>: This is buggy)</p>

<p>For record configuraton into file you need to run simulation with key -l_to - it create 3 new files 
at the folder ./buffers:</p>

<ul>
<li>connection_buffers.txt - it need to store information about conection among of elastic partciles</li>
<li>membranes_buffer.txt   - it need to store information about membranes </li>
<li>position_buffer.txt    - it need to store information current position all of the non boundary particles it save information to this file every 10 steps of simulation. You shoulld remember that than more info you 
want to store than bigger output file is. </li>
</ul><p>For view result you should run simulation with key -l_from - it get positions from position_buffer.txt file and 
draw evolution of system in time</p>

<h2>
<a name="making-videos-nix" class="anchor" href="#making-videos-nix"><span class="octicon octicon-link"></span></a>Making videos (*nix)</h2>

<p>If you run a simulation you may be interested in recording the graphical output. Making such videos is a bit tricky because they need to be speeded up, so far I have found the following two commands do a decent job (change folder names accordingly) after you have used a screen record program:</p>

<pre><code>#If your video is in OGV  format (if you used recordmydesktop for instance), use the following script to convert to avi:

#!/bin/bash
 # ogv to avi
 # Call this with multiple arguments
 # for example : ls *.{ogv,OGV} | xargs ogv2avi
 N=$#;
 echo "Converting $N files !"
 for ((i=0; i&lt;=(N-1); i++))
 do
 echo "converting" $1
 filename=${1%.*}
 mencoder "$1" -ovc xvid -oac mp3lame -xvidencopts pass=1 -o $filename.avi
 shift 1
 done
</code></pre>

<pre><code>#make images from video
ffmpeg -i crawley_6.avi -r 0.05 -f image2 ~/Documents/tmp/output-%06d.jpg
</code></pre>

<pre><code>#re-encode into video
ffmpeg -r 100 -i output-%06d.jpg -r 100 -vb 60M speeded_worm.mp4
</code></pre>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/openworm">openworm</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>